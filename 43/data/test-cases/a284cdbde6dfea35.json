{"uid":"a284cdbde6dfea35","name":"Картинки в яндексе","fullName":"test.test_tensor.TensorTestCase#test_pictures","historyId":"9214267beedc59fe8c2f8d4f710a67a6","time":{"start":1659206677564,"stop":1659206695191,"duration":17627},"status":"failed","statusMessage":"AssertionError: Текущая картинка не равна эталонной","statusTrace":"self = <test.test_tensor.TensorTestCase testMethod=test_pictures>\n\n    @allure.title('Картинки в яндексе')\n    def test_pictures(self):\n        self.hp.navigation.click_navigation(\"Картинки\", True, Stere.browser)\n        ip = Images_Page(Stere.browser)\n        top_category = ip.popular_items.get_top_item()\n    \n        sr = ip.popular_items.click_category(top_category)\n        sr.search_form.assert_query(top_category)\n        top_result = sr.get_top_result()\n    \n        iv = sr.click_result(top_result)\n        top_image = iv.download_current_image()\n        iv.next()\n        iv.compare_images(False, top_image)\n        iv.prev()\n>       iv.compare_images(True, top_image)\n\ntest/test_tensor.py:61: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <src.pages.search_results.Image_Viewer object at 0x7f917de62fb0>\nshould_equal = True\nother_image = b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\x01\\x00\\x01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x04\\x04\\x05\\x04\\x03\\x05\\x0...+\\x9b\\xae)\\x7fy5\\xd0\\xd98\\xa4\\xa1\\xba%\\xe2\\xcdN\\xca\\x82\\x97\\xb7J\\xa7\\xc5\\xfb\\xc6\\xa5e\\xce\\x05\\x13\\x9aF\\x14\\xcf\\xff\\xd9'\n\n    @allure.step(\"Сравнить текущую картинку с эталонной. Ожидаемый результат сравнения: {1}\")\n    def compare_images(self, should_equal, other_image):\n        current_image = self.download_current_image()\n        current = Image.open(io.BytesIO(current_image)).convert('RGB')\n        other = Image.open(io.BytesIO(other_image)).convert('RGB')\n        if other.size > current.size:\n            other = other.resize(current.size)\n        elif other.size < current.size:\n            current = current.resize(other.size)\n        equal = list(current.getdata()) == list(other.getdata())\n        prefix = ''\n    \n        other_bytes = io.BytesIO()\n        other.save(other_bytes, format='PNG')\n        other_bytes = other_bytes.getvalue()\n    \n        current_bytes = io.BytesIO()\n        current.save(current_bytes, format='PNG')\n        current_bytes = current_bytes.getvalue()\n    \n        allure.attach(other_bytes, \"Эталонное изображение\", allure.attachment_type.JPG)\n        allure.attach(current_bytes, \"Текущее изображение\", allure.attachment_type.JPG)\n        if should_equal:\n>           assert equal is True, \"Текущая картинка не равна эталонной\"\nE           AssertionError: Текущая картинка не равна эталонной\n\nsrc/pages/search_results.py:60: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_unittest_setUpClass_fixture_TensorTestCase","time":{"start":1659206677546,"stop":1659206677546,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Текущая картинка не равна эталонной","statusTrace":"self = <test.test_tensor.TensorTestCase testMethod=test_pictures>\n\n    @allure.title('Картинки в яндексе')\n    def test_pictures(self):\n        self.hp.navigation.click_navigation(\"Картинки\", True, Stere.browser)\n        ip = Images_Page(Stere.browser)\n        top_category = ip.popular_items.get_top_item()\n    \n        sr = ip.popular_items.click_category(top_category)\n        sr.search_form.assert_query(top_category)\n        top_result = sr.get_top_result()\n    \n        iv = sr.click_result(top_result)\n        top_image = iv.download_current_image()\n        iv.next()\n        iv.compare_images(False, top_image)\n        iv.prev()\n>       iv.compare_images(True, top_image)\n\ntest/test_tensor.py:61: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <src.pages.search_results.Image_Viewer object at 0x7f917de62fb0>\nshould_equal = True\nother_image = b'\\xff\\xd8\\xff\\xe0\\x00\\x10JFIF\\x00\\x01\\x01\\x00\\x00\\x01\\x00\\x01\\x00\\x00\\xff\\xdb\\x00C\\x00\\x05\\x04\\x04\\x05\\x04\\x03\\x05\\x0...+\\x9b\\xae)\\x7fy5\\xd0\\xd98\\xa4\\xa1\\xba%\\xe2\\xcdN\\xca\\x82\\x97\\xb7J\\xa7\\xc5\\xfb\\xc6\\xa5e\\xce\\x05\\x13\\x9aF\\x14\\xcf\\xff\\xd9'\n\n    @allure.step(\"Сравнить текущую картинку с эталонной. Ожидаемый результат сравнения: {1}\")\n    def compare_images(self, should_equal, other_image):\n        current_image = self.download_current_image()\n        current = Image.open(io.BytesIO(current_image)).convert('RGB')\n        other = Image.open(io.BytesIO(other_image)).convert('RGB')\n        if other.size > current.size:\n            other = other.resize(current.size)\n        elif other.size < current.size:\n            current = current.resize(other.size)\n        equal = list(current.getdata()) == list(other.getdata())\n        prefix = ''\n    \n        other_bytes = io.BytesIO()\n        other.save(other_bytes, format='PNG')\n        other_bytes = other_bytes.getvalue()\n    \n        current_bytes = io.BytesIO()\n        current.save(current_bytes, format='PNG')\n        current_bytes = current_bytes.getvalue()\n    \n        allure.attach(other_bytes, \"Эталонное изображение\", allure.attachment_type.JPG)\n        allure.attach(current_bytes, \"Текущее изображение\", allure.attachment_type.JPG)\n        if should_equal:\n>           assert equal is True, \"Текущая картинка не равна эталонной\"\nE           AssertionError: Текущая картинка не равна эталонной\n\nsrc/pages/search_results.py:60: AssertionError","steps":[{"name":"Перейти на главную страницу Яндекса","time":{"start":1659206678703,"stop":1659206678703,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"Кликнуть на ссылку на раздел \"'Картинки'\" на панели навигации в верхней части страницы","time":{"start":1659206683654,"stop":1659206684334,"duration":680},"status":"passed","steps":[{"name":"Закрыть окно браузера с названием 'Яндекс'","time":{"start":1659206684192,"stop":1659206684334,"duration":142},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"browser","value":"<splinter.driver.webdriver.remote.WebDriver object at 0x7f917ca1f580>"},{"name":"window_name","value":"'CDwindow-600CABCC46A83C244362C596620572CB'"},{"name":"title","value":"'Яндекс'"}],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true}],"attachments":[],"parameters":[{"name":"section","value":"'Картинки'"},{"name":"close_prev_window","value":"True"},{"name":"browser","value":"<splinter.driver.webdriver.remote.WebDriver object at 0x7f917ca1f580>"}],"stepsCount":1,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true},{"name":"Перейти в раздел \"Картинки\"","time":{"start":1659206684334,"stop":1659206685517,"duration":1183},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"browser","value":"<splinter.driver.webdriver.remote.WebDriver object at 0x7f917ca1f580>"}],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true},{"name":"Кликнуть на категорию \"'Тортики'","time":{"start":1659206685552,"stop":1659206686213,"duration":661},"status":"passed","steps":[{"name":"Перейти на страницу результатов поиска","time":{"start":1659206686213,"stop":1659206686213,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"mode","value":"'image'"}],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true}],"attachments":[],"parameters":[{"name":"cat_name","value":"'Тортики'"}],"stepsCount":1,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true},{"name":"Проверить, что в строке поиска отображается 'Тортики'","time":{"start":1659206686213,"stop":1659206686248,"duration":35},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"query","value":"'Тортики'"}],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true},{"name":"Кликнуть на картинку","time":{"start":1659206687060,"stop":1659206687060,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"Кликнуть на стрелку вправо","time":{"start":1659206688010,"stop":1659206693134,"duration":5124},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"Сравнить текущую картинку с эталонной. Ожидаемый результат сравнения: False","time":{"start":1659206693134,"stop":1659206694118,"duration":984},"status":"passed","steps":[],"attachments":[{"uid":"a9e83e8812bd89af","name":"Эталонное изображение","source":"a9e83e8812bd89af.jpg","type":"image/jpg","size":106724},{"uid":"55b972e6b26880ce","name":"Текущее изображение","source":"55b972e6b26880ce.jpg","type":"image/jpg","size":133112},{"uid":"131c594f7ba516db","name":"Сравнение изображений","source":"131c594f7ba516db.txt","type":"text/plain","size":66}],"parameters":[{"name":"should_equal","value":"False"},{"name":"other_image","value":"<class 'bytes'>"}],"stepsCount":0,"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true},{"name":"Кликнуть на стрелку влево","time":{"start":1659206694118,"stop":1659206694226,"duration":108},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false},{"name":"Сравнить текущую картинку с эталонной. Ожидаемый результат сравнения: True","time":{"start":1659206694226,"stop":1659206695138,"duration":912},"status":"failed","statusMessage":"AssertionError: Текущая картинка не равна эталонной\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.10.5/x64/lib/python3.10/site-packages/allure_commons/_allure.py\", line 172, in impl\n    return func(*a, **kw)\n  File \"/home/runner/work/2022_07_tensor_test_assignment/2022_07_tensor_test_assignment/src/pages/search_results.py\", line 60, in compare_images\n    assert equal is True, \"Текущая картинка не равна эталонной\"\n","steps":[],"attachments":[{"uid":"229de01c19ec089c","name":"Эталонное изображение","source":"229de01c19ec089c.jpg","type":"image/jpg","size":106724},{"uid":"f6467549264331c2","name":"Текущее изображение","source":"f6467549264331c2.jpg","type":"image/jpg","size":110585}],"parameters":[{"name":"should_equal","value":"True"},{"name":"other_image","value":"<class 'bytes'>"}],"stepsCount":0,"attachmentsCount":2,"shouldDisplayMessage":true,"hasContent":true}],"attachments":[],"parameters":[],"stepsCount":12,"attachmentsCount":5,"shouldDisplayMessage":true,"hasContent":true},"afterStages":[{"name":"_unittest_setUpClass_fixture_TensorTestCase::0","time":{"start":1659206703372,"stop":1659206703372,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false}],"labels":[{"name":"parentSuite","value":"test"},{"name":"suite","value":"test_tensor"},{"name":"subSuite","value":"TensorTestCase"},{"name":"host","value":"fv-az241-667"},{"name":"thread","value":"2692-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test.test_tensor"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":7,"broken":3,"skipped":0,"passed":0,"unknown":0,"total":10},"items":[{"uid":"c1e091dab22d7fab","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/42//#testresult/c1e091dab22d7fab","status":"failed","statusDetails":"AssertionError: Текущая картинка не равна эталонной","time":{"start":1659199986223,"stop":1659200003873,"duration":17650}},{"uid":"5d6443300745f2e8","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/41//#testresult/5d6443300745f2e8","status":"failed","statusDetails":"AssertionError","time":{"start":1659196928824,"stop":1659196944449,"duration":15625}},{"uid":"6de857efb89c5249","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/39//#testresult/6de857efb89c5249","status":"failed","statusDetails":"AssertionError","time":{"start":1659194295271,"stop":1659194313587,"duration":18316}},{"uid":"a90370f86e506b68","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/38//#testresult/a90370f86e506b68","status":"failed","statusDetails":"AssertionError","time":{"start":1659193948639,"stop":1659193962862,"duration":14223}},{"uid":"474236cc787eb95b","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/37//#testresult/474236cc787eb95b","status":"failed","statusDetails":"AssertionError","time":{"start":1659193812291,"stop":1659193828075,"duration":15784}},{"uid":"ccfe1d233497285e","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/36//#testresult/ccfe1d233497285e","status":"failed","statusDetails":"AssertionError","time":{"start":1659191720033,"stop":1659191734699,"duration":14666}},{"uid":"8e0495c32f8aaff9","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/34//#testresult/8e0495c32f8aaff9","status":"broken","statusDetails":"urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=4444): Max retries exceeded with url: /wd/hub/session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f5723152d70>: Failed to establish a new connection: [Errno 111] Connection refused'))","time":{"start":1659191418119,"stop":1659191418151,"duration":32}},{"uid":"a4ec9ca0d56c6061","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/33//#testresult/a4ec9ca0d56c6061","status":"broken","statusDetails":"urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=4444): Max retries exceeded with url: /wd/hub/session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fea7fed6170>: Failed to establish a new connection: [Errno 111] Connection refused'))","time":{"start":1659191268197,"stop":1659191268219,"duration":22}},{"uid":"db2ce8f094a32e74","reportUrl":"https://schastev.github.io/2022_07_tensor_test_assignment/31//#testresult/db2ce8f094a32e74","status":"broken","statusDetails":"urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=4444): Max retries exceeded with url: /wd/hub/session (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f7ddcf2a1d0>: Failed to establish a new connection: [Errno 111] Connection refused'))","time":{"start":1659191009401,"stop":1659191009421,"duration":20}}]},"tags":[]},"source":"a284cdbde6dfea35.json","parameterValues":[]}